import{a as w}from"./chunk-EIXP5TK4.js";import{J as p,Q as m,U as v,_ as y,m as d,w as f,za as l}from"./chunk-7FIF2LK4.js";var g=function(c){return c.africa="africa",c.americas="americas",c.asia="asia",c.europe="europe",c.oceania="oceania",c}(g||{});var W=(()=>{let u=class u{constructor(){this.http=y(w),this.loading=l(!0),this.countries=l(new Map),this.countriesIdsByRegion=l(new Map),this.visitedCounters=l({total:0,byRegion:new Map}),this.wishedCounters=l({total:0,byRegion:new Map}),this.loadCountries()}getWishedSaved(){let t=localStorage.getItem("wish");return t?t.split(","):[]}getVisitedSaved(){let t=localStorage.getItem("visited");return t?t.split(","):[]}setVisited(t,e){t.isInVisitedList=e}setWished(t,e){t.isInWishList=e}loadCountries(){f([d(this.getVisitedSaved()),d(this.getWishedSaved()),this.http.get("https://restcountries.com/v3.1/all?fields=name,cca3,capital,region,subregion,flags")]).pipe(p(),m(([t,e,i])=>{let s=new Map;for(let r of Object.keys(g))s.set(r,i.filter(h=>h.region.toLowerCase()===r).map(h=>h.cca3));let o=new Map;for(let r of i)r.id=r.cca3,r.region=r.region.toLocaleLowerCase(),this.setVisited(r,t.includes(r.id)),this.setWished(r,e.includes(r.id)),o.set(r.id,r);this.countries.set(o),this.countriesIdsByRegion.set(s),this.loading.set(!1);let n=Array.from(o.values()).filter(r=>r.isInVisitedList),a=Array.from(o.values()).filter(r=>r.isInWishList);this.setVisitedCounter(n,!0),this.setWishCounter(a,!0)})).subscribe()}updateVisited(t,e){let i=this.getVisitedSaved();e?i.push(t):i=i.filter(n=>n!==t),localStorage.setItem("visited",i.join(","));let s=this.countries(),o=s.get(t);this.setVisited(o,e),this.countries.set(s),this.setVisitedCounter([o],e)}updateWished(t,e){let i=this.getWishedSaved();e?i.push(t):i=i.filter(n=>n!==t),localStorage.setItem("wish",i.join(","));let s=this.countries(),o=s.get(t);this.setWished(o,e),this.countries.set(s),this.setWishCounter([o],e)}setVisitedCounter(t,e){let i=this.visitedCounters(),s=i.total,o=i.byRegion;for(let n of t){s=e?s+1:s-1;let a=o.get(n.region)||0;a=e?a+1:a-1,o.set(n.region,a)}this.visitedCounters.set({total:s,byRegion:o})}setWishCounter(t,e){let i=this.wishedCounters(),s=i.total,o=i.byRegion;for(let n of t){s=e?s+1:s-1;let a=o.get(n.region)||0;a=e?a+1:a-1,o.set(n.region,a)}this.wishedCounters.set({total:s,byRegion:o})}};u.\u0275fac=function(e){return new(e||u)},u.\u0275prov=v({token:u,factory:u.\u0275fac,providedIn:"root"});let c=u;return c})();export{g as a,W as b};
